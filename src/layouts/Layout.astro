---
import Navbar from "../components/common/Navbar.astro";
import Footer from "../components/common/Footer.astro";
import "aos/dist/aos.css";
import "../styles/global.css";

const {
  title = "Boutee - Home",
  description = "Find your perfect handcrafted ring...",
  ogImage = "../assets/Logo.svg"
} = Astro.props;

import { VisualEditing } from "@sanity/astro/visual-editing";

const visualEditingEnabled =
  import.meta.env.PUBLIC_SANITY_VISUAL_EDITING_ENABLED == "true";
---

<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="icon" type="image/svg+xml" href="/Logo.svg" />
    <meta name="generator" content={Astro.generator} />

    <title>{title}</title>
    <meta name="description" content={description} />
    
    <!-- OG TAGS -->
    <meta property="og:title" content={title} />
    <meta property="og:description" content={description} />
    <meta property="og:image" content={ogImage} />

    <meta name="twitter:card" content="summary_large_image" />
    <meta name="twitter:title" content={title} />
    <meta name="twitter:description" content={description} />
    <meta name="twitter:image" content={ogImage} />
  </head>

  <body class="flex flex-col min-h-screen scroll-smooth">
    <Navbar />

    <main class="flex-1">
      <slot />
      <VisualEditing enabled={visualEditingEnabled} />
    </main>

    <Footer />

    <!-- ðŸŸ¢ AOS CDN (WORKS PERFECTLY ON VERCEL) -->
    <script src="https://unpkg.com/aos@2.3.4/dist/aos.js"></script>
    <script>
      AOS.init({
        duration: 500,
        once: false,
      });
    </script>

    <!-- ðŸŸ¢ YOUR CUSTOM JS -->
    <script>
      document.addEventListener("DOMContentLoaded", () => {
        // SPIN BUTTONS
        const buttons = document.querySelectorAll(".spinBtn");
        buttons.forEach((btn) => {
          const icon = btn.querySelector(".btnIcon");
          if (!icon) return;

          btn.addEventListener("click", () => {
            icon.classList.remove("animate-spin-once");
            void icon.offsetWidth;
            icon.classList.add("animate-spin-once");
          });
        });

        // PARALLAX
        let ticking = false;
        const updateParallax = () => {
          document.querySelectorAll(".floating").forEach((el) => {
            const speed = parseFloat(el.dataset.speed) || 0.3;
            const offset = window.scrollY * speed * -0.4;
            el.style.setProperty("--parallaxY", `${offset}px`);
          });
          ticking = false;
        };
        window.addEventListener("scroll", () => {
          if (!ticking) {
            window.requestAnimationFrame(updateParallax);
            ticking = true;
          }
        });

        // INTERSECTION ANIMATIONS
        const target = document.querySelector(".wrapper");
        if (target) {
          const observer = new IntersectionObserver(
            (entries) => {
              entries.forEach((entry) => {
                target.classList.toggle("animate", entry.isIntersecting);
              });
            },
            { threshold: 0.3 }
          );
          observer.observe(target);
        }
      });
    </script>
  </body>
</html>
